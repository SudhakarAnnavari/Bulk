{"text": "2023-08-03 13:11:38.818 | ERROR    | __main__:<module>:28 - Usage is python run_csv.py <csv>\n", "record": {"elapsed": {"repr": "0:00:00.264089", "seconds": 0.264089}, "exception": null, "extra": {}, "file": {"name": "run_csv.py", "path": "/mnt/c/Users/chakr/Downloads/Github/Fincraft/bulk-downloader/run_csv.py"}, "function": "<module>", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 28, "message": "Usage is python run_csv.py <csv>", "module": "run_csv", "name": "__main__", "process": {"id": 3032, "name": "MainProcess"}, "thread": {"id": 140086838187840, "name": "MainThread"}, "time": {"repr": "2023-08-03 13:11:38.818091+05:30", "timestamp": 1691048498.818091}}}
{"text": "2024-07-04 00:23:01.904 | ERROR    | __main__:handle_upload:86 - Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.\n", "record": {"elapsed": {"repr": "0:00:12.562614", "seconds": 12.562614}, "exception": null, "extra": {}, "file": {"name": "win_main.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win_main.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 86, "message": "Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.", "module": "win_main", "name": "__main__", "process": {"id": 20876, "name": "MainProcess"}, "thread": {"id": 10304, "name": "MainThread"}, "time": {"repr": "2024-07-04 00:23:01.904249+05:30", "timestamp": 1720032781.904249}}}
{"text": "2024-07-04 00:23:40.187 | ERROR    | __main__:handle_upload:86 - Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.\n", "record": {"elapsed": {"repr": "0:00:13.301942", "seconds": 13.301942}, "exception": null, "extra": {}, "file": {"name": "win_main.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win_main.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 86, "message": "Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.", "module": "win_main", "name": "__main__", "process": {"id": 11632, "name": "MainProcess"}, "thread": {"id": 10328, "name": "MainThread"}, "time": {"repr": "2024-07-04 00:23:40.187638+05:30", "timestamp": 1720032820.187638}}}
{"text": "2024-07-04 00:24:41.647 | ERROR    | __main__:handle_upload:86 - Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.\n", "record": {"elapsed": {"repr": "0:00:08.248285", "seconds": 8.248285}, "exception": null, "extra": {}, "file": {"name": "win_main.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win_main.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 86, "message": "Error handling upload: It looks like you are using Playwright Sync API inside the asyncio loop.\nPlease use the Async API instead.", "module": "win_main", "name": "__main__", "process": {"id": 17908, "name": "MainProcess"}, "thread": {"id": 14140, "name": "MainThread"}, "time": {"repr": "2024-07-04 00:24:41.647554+05:30", "timestamp": 1720032881.647554}}}
{"text": "2024-07-04 13:20:23.546 | ERROR    | app.process:insert_bulk_download:107 - Error inserting data into bulk_download table: column \"total_files_count\" of relation \"bulk_download\" does not exist\nLINE 2:         INSERT INTO bulk_download (total_files_count, unproc...\n                                           ^\n\n", "record": {"elapsed": {"repr": "0:01:24.008721", "seconds": 84.008721}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 107, "message": "Error inserting data into bulk_download table: column \"total_files_count\" of relation \"bulk_download\" does not exist\nLINE 2:         INSERT INTO bulk_download (total_files_count, unproc...\n                                           ^\n", "module": "process", "name": "app.process", "process": {"id": 15584, "name": "MainProcess"}, "thread": {"id": 10520, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-04 13:20:23.546097+05:30", "timestamp": 1720079423.546097}}}
{"text": "2024-07-04 13:22:19.495 | ERROR    | app.process:insert_bulk_download:107 - Error inserting data into bulk_download table: invalid input syntax for type json\nLINE 3:         VALUES (34, 4, 'https://finkraft-invoices-outstation...\n                               ^\nDETAIL:  Token \"https\" is invalid.\nCONTEXT:  JSON data, line 1: https...\n\n", "record": {"elapsed": {"repr": "0:00:22.402214", "seconds": 22.402214}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 107, "message": "Error inserting data into bulk_download table: invalid input syntax for type json\nLINE 3:         VALUES (34, 4, 'https://finkraft-invoices-outstation...\n                               ^\nDETAIL:  Token \"https\" is invalid.\nCONTEXT:  JSON data, line 1: https...\n", "module": "process", "name": "app.process", "process": {"id": 17416, "name": "MainProcess"}, "thread": {"id": 13744, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-04 13:22:19.495327+05:30", "timestamp": 1720079539.495327}}}
{"text": "2024-07-04 13:25:03.469 | ERROR    | app.process:insert_bulk_download:107 - Error inserting data into bulk_download table: invalid input syntax for type json\nLINE 3:         VALUES (34, 4, 'https://finkraft-invoices-outstation...\n                               ^\nDETAIL:  Token \"https\" is invalid.\nCONTEXT:  JSON data, line 1: https...\n\n", "record": {"elapsed": {"repr": "0:00:32.890737", "seconds": 32.890737}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 107, "message": "Error inserting data into bulk_download table: invalid input syntax for type json\nLINE 3:         VALUES (34, 4, 'https://finkraft-invoices-outstation...\n                               ^\nDETAIL:  Token \"https\" is invalid.\nCONTEXT:  JSON data, line 1: https...\n", "module": "process", "name": "app.process", "process": {"id": 23912, "name": "MainProcess"}, "thread": {"id": 4860, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-04 13:25:03.469772+05:30", "timestamp": 1720079703.469772}}}
{"text": "2024-07-04 13:45:20.134 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: column \"error_url\" of relation \"bulk_download\" does not exist\nLINE 2: ...ERT INTO bulk_download (total_files, unprocessed, error_url,...\n                                                             ^\n\n", "record": {"elapsed": {"repr": "0:10:51.809736", "seconds": 651.809736}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: column \"error_url\" of relation \"bulk_download\" does not exist\nLINE 2: ...ERT INTO bulk_download (total_files, unprocessed, error_url,...\n                                                             ^\n", "module": "process", "name": "app.process", "process": {"id": 17216, "name": "MainProcess"}, "thread": {"id": 10208, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-04 13:45:20.134771+05:30", "timestamp": 1720080920.134771}}}
{"text": "2024-07-17 22:45:23.655 | ERROR    | __main__:run_subprocess:52 - Subprocess failed with error: C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\python.exe: can't open file 'C:\\\\Users\\\\annav\\\\Desktop\\\\BulkDownload\\\\Bulk_download\\\\subprocess.py': [Errno 2] No such file or directory\n\n", "record": {"elapsed": {"repr": "0:01:39.150364", "seconds": 99.150364}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 52, "message": "Subprocess failed with error: C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\python.exe: can't open file 'C:\\\\Users\\\\annav\\\\Desktop\\\\BulkDownload\\\\Bulk_download\\\\subprocess.py': [Errno 2] No such file or directory\n", "module": "win", "name": "__main__", "process": {"id": 19380, "name": "MainProcess"}, "thread": {"id": 1360, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-17 22:45:23.655572+05:30", "timestamp": 1721236523.655572}}}
{"text": "2024-07-17 22:47:19.948 | ERROR    | __main__:run_subprocess:52 - Subprocess failed with error: Traceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 6, in <module>\n    import boto3\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\__init__.py\", line 17, in <module>\n    from boto3.session import Session\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\session.py\", line 17, in <module>\n    import botocore.session\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\session.py\", line 28, in <module>\n    import botocore.credentials\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\credentials.py\", line 19, in <module>\n    import subprocess\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 11, in <module>\n    from app.zohomail import send_zoho_mail\nModuleNotFoundError: No module named 'app'\n\n", "record": {"elapsed": {"repr": "0:00:06.427058", "seconds": 6.427058}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 52, "message": "Subprocess failed with error: Traceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 6, in <module>\n    import boto3\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\__init__.py\", line 17, in <module>\n    from boto3.session import Session\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\session.py\", line 17, in <module>\n    import botocore.session\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\session.py\", line 28, in <module>\n    import botocore.credentials\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\credentials.py\", line 19, in <module>\n    import subprocess\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 11, in <module>\n    from app.zohomail import send_zoho_mail\nModuleNotFoundError: No module named 'app'\n", "module": "win", "name": "__main__", "process": {"id": 24136, "name": "MainProcess"}, "thread": {"id": 5576, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-17 22:47:19.948259+05:30", "timestamp": 1721236639.948259}}}
{"text": "2024-07-17 22:51:03.981 | ERROR    | __main__:run_subprocess:52 - Subprocess failed with error: Traceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 3, in <module>\n    from app.process import process_upload\nModuleNotFoundError: No module named 'app'\n\n", "record": {"elapsed": {"repr": "0:00:06.562865", "seconds": 6.562865}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 52, "message": "Subprocess failed with error: Traceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\subprocess.py\", line 3, in <module>\n    from app.process import process_upload\nModuleNotFoundError: No module named 'app'\n", "module": "win", "name": "__main__", "process": {"id": 22772, "name": "MainProcess"}, "thread": {"id": 2724, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-17 22:51:03.981278+05:30", "timestamp": 1721236863.981278}}}
{"text": "2024-07-17 23:05:43.549 | ERROR    | __main__:handle_upload:81 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 88, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x000001C65C700170>\n    │       └ <function run at 0x000001C65C9F37E0>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x000001C65CA322A0>\n    └ <uvicorn.server.Server object at 0x000001C65C89C2C0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x000001C65CA32340>\n           │       │   └ <uvicorn.server.Server object at 0x000001C65C89C2C0>\n           │       └ <function run at 0x000001C65A106C00>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x000001C65CAB1D20>\n           │      └ <function Runner.run at 0x000001C65A131EE0>\n           └ <asyncio.runners.Runner object at 0x000001C65C8E0800>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001C65A12FB00>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x000001C65C8E0800>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x000001C65A1E7600>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x000001C65A1318A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x000001C65A09DA80>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C65C78E150>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C65C...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x000001C65C700170>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001C65C78E150>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C65C...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C65C...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C65CB32C60>\n          └ <fastapi.applications.FastAPI object at 0x000001C65C700170>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001C65CAA56C0>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001C65CB32BA0>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001C65CB32C60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'localhost:5000', 'connection': 'keep-alive', 'content-length': '6083', 'sec-ch-ua': '\"Not/A)Brand\";v=\"8\", \"...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001C65CAA56C0>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x000001C65C7F82C0>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001C65CB32BA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001C65CB32BA0...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C65CB30350>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001C65CB32BA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001C65CB32BA0...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x000001C65CB33710>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x000001C65C955B50>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001C65CB30350>\n          └ <function wrap_app_handling_exceptions at 0x000001C65C716480>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4C900>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x000001C65C955B50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4C900>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001C65C955B50>>\n          └ <fastapi.routing.APIRouter object at 0x000001C65C955B50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4C900>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x000001C65C717920>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4C900>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x000001C65CAA5260>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4C900>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x000001C65CB338C0>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001C65CB4C9A0>\n          └ <function wrap_app_handling_exceptions at 0x000001C65C716480>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001C65CB4CAE0>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001C...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x000001C65CB4C9A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x000001C65CB338C0>\n                     └ <function get_request_handler.<locals>.app at 0x000001C65CAA51C0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x000001C65C715C60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'annavarisudhakar@gmail.com', 'file': UploadFile(filename='Bulk_Download_demofile.csv', size=5665, headers=Headers(...\n                 │         └ <function handle_upload at 0x000001C65CA43880>\n                 └ <fastapi.dependencies.models.Dependant object at 0x000001C65CAA0C50>\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 79, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'annavarisudhakar@gmail.com'\n             │              └ './data/Bulk_Download_demofile0190c1c3-2b61-77cb-a464-bcba56eccea4.csv'\n             └ <function run_subprocess at 0x000001C65CA43600>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 55, in run_subprocess\n    return json.loads(result.stdout)\n           │    │     │      └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n           │    │     └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'processcall.py', './data...\n           │    └ <function loads at 0x000001C65A6F8400>\n           └ <module 'json' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\json\\\\__init__.py'>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           │                │      └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n           │                └ <function JSONDecoder.decode at 0x000001C65A6DFD80>\n           └ <json.decoder.JSONDecoder object at 0x000001C65A6E0320>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               │    │          │      │  └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n               │    │          │      └ <built-in method match of re.Pattern object at 0x000001C65A67ADC0>\n               │    │          └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n               │    └ <function JSONDecoder.raw_decode at 0x000001C65A6DFE20>\n               └ <json.decoder.JSONDecoder object at 0x000001C65A6E0320>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\n          │                                  └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n          └ <class 'json.decoder.JSONDecodeError'>\n\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n", "record": {"elapsed": {"repr": "0:00:36.272521", "seconds": 36.272521}, "exception": {"type": "JSONDecodeError", "value": "Expecting value: line 1 column 1 (char 0)", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 81, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 11756, "name": "MainProcess"}, "thread": {"id": 20648, "name": "MainThread"}, "time": {"repr": "2024-07-17 23:05:43.549447+05:30", "timestamp": 1721237743.549447}}}
{"text": "2024-07-17 23:15:31.497 | ERROR    | __main__:run_subprocess:62 - Failed to decode JSON output: Zipping folder\nSent\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"pre-signed\": \"https://finkraft-invoices-outstation.s3.amazonaws.com/downloadables/Jul17/20240717231524881597-invoices.zip?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAWVKQBF2L47ZDIG6F%2F20240717%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20240717T174527Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=cd53491567837cc08bbcd8910af2ff774ceb84c4056c2ea2a3553bd34145db67\", \"details\": {\"total\": 34, \"skipped\": {\"Error\": {}}, \"not_existing\": [\"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01AAB3 35.pdf,272412BP01AAB335.pdf,AIR INDIA LTD.,12346\", \"https://airline-engine-scraped.s3.am azonaws.com/v0/WebScraping/airindia/232412BP02AAC1 32.pdf,232412BP02AAC132.pdf,AIR INDIA LTD.,12350\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01ABC 990.pdf,272412BP01ABC990.pdf,AIR INDIA LTD.,12353\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/072412BP01AAK 222.pdf,072412BP01AAK222.pdf,AIR INDIA LTD.,12356\"], \"invalid_access\": [], \"invalid_s3\": []}}\n\n", "record": {"elapsed": {"repr": "0:00:26.091700", "seconds": 26.0917}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 62, "message": "Failed to decode JSON output: Zipping folder\nSent\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"pre-signed\": \"https://finkraft-invoices-outstation.s3.amazonaws.com/downloadables/Jul17/20240717231524881597-invoices.zip?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAWVKQBF2L47ZDIG6F%2F20240717%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20240717T174527Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=cd53491567837cc08bbcd8910af2ff774ceb84c4056c2ea2a3553bd34145db67\", \"details\": {\"total\": 34, \"skipped\": {\"Error\": {}}, \"not_existing\": [\"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01AAB3 35.pdf,272412BP01AAB335.pdf,AIR INDIA LTD.,12346\", \"https://airline-engine-scraped.s3.am azonaws.com/v0/WebScraping/airindia/232412BP02AAC1 32.pdf,232412BP02AAC132.pdf,AIR INDIA LTD.,12350\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01ABC 990.pdf,272412BP01ABC990.pdf,AIR INDIA LTD.,12353\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/072412BP01AAK 222.pdf,072412BP01AAK222.pdf,AIR INDIA LTD.,12356\"], \"invalid_access\": [], \"invalid_s3\": []}}\n", "module": "win", "name": "__main__", "process": {"id": 4684, "name": "MainProcess"}, "thread": {"id": 12256, "name": "MainThread"}, "time": {"repr": "2024-07-17 23:15:31.497747+05:30", "timestamp": 1721238331.497747}}}
{"text": "2024-07-17 23:15:31.498 | ERROR    | __main__:handle_upload:89 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 57, in run_subprocess\n    return json.loads(result.stdout)\n           │    │     │      └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n           │    │     └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n           │    └ <function loads at 0x000001EE8AAD8400>\n           └ <module 'json' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\json\\\\__init__.py'>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\__init__.py\", line 346, in loads\n    return _default_decoder.decode(s)\n           │                │      └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n           │                └ <function JSONDecoder.decode at 0x000001EE8AAC3D80>\n           └ <json.decoder.JSONDecoder object at 0x000001EE8AAB8D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\decoder.py\", line 337, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               │    │          │      │  └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n               │    │          │      └ <built-in method match of re.Pattern object at 0x000001EE8AA5EDC0>\n               │    │          └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n               │    └ <function JSONDecoder.raw_decode at 0x000001EE8AAC3E20>\n               └ <json.decoder.JSONDecoder object at 0x000001EE8AAB8D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\json\\decoder.py\", line 355, in raw_decode\n    raise JSONDecodeError(\"Expecting value\", s, err.value) from None\n          │                                  └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n          └ <class 'json.decoder.JSONDecodeError'>\n\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 96, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x000001EE8CB3F0B0>\n    │       └ <function run at 0x000001EE8CDD77E0>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x000001EE8CE122A0>\n    └ <uvicorn.server.Server object at 0x000001EE8CDE2D80>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x000001EE8CE12340>\n           │       │   └ <uvicorn.server.Server object at 0x000001EE8CDE2D80>\n           │       └ <function run at 0x000001EE8A4E6C00>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x000001EE8CE91D20>\n           │      └ <function Runner.run at 0x000001EE8A511EE0>\n           └ <asyncio.runners.Runner object at 0x000001EE8CE33F80>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EE8A50FB00>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x000001EE8CE33F80>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x000001EE8A5C7600>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x000001EE8A5118A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x000001EE8A47DA80>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EE8CB3F380>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001EE8C...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x000001EE8CB3F0B0>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x000001EE8CB3F380>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001EE8C...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001EE8C...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EE8CADDE20>\n          └ <fastapi.applications.FastAPI object at 0x000001EE8CB3F0B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001EE8CF2C680>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EE8CDBF6E0>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x000001EE8CADDE20>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'localhost:5000', 'connection': 'keep-alive', 'content-length': '6083', 'sec-ch-ua': '\"Not/A)Brand\";v=\"8\", \"...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001EE8CF2C680>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x000001EE8CBD82C0>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EE8CDBF6E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001EE8CDBF6E0...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EE8CF0B860>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001EE8CDBF6E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001EE8CDBF6E0...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x000001EE8CF38320>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x000001EE8CCB83E0>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001EE8CF0B860>\n          └ <function wrap_app_handling_exceptions at 0x000001EE8CAF6480>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2C900>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x000001EE8CCB83E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2C900>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001EE8CCB83E0>>\n          └ <fastapi.routing.APIRouter object at 0x000001EE8CCB83E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2C900>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x000001EE8CAF7920>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2C900>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x000001EE8CE85260>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2C900>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x000001EE8CF38530>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001EE8CF2C9A0>\n          └ <function wrap_app_handling_exceptions at 0x000001EE8CAF6480>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001EE8CF2CAE0>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x000001E...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x000001EE8CF2C9A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x000001EE8CF38530>\n                     └ <function get_request_handler.<locals>.app at 0x000001EE8CE851C0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x000001EE8CAF5C60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'annavarisudhakar@gmail.com', 'file': UploadFile(filename='Bulk_Download_demofile.csv', size=5665, headers=Headers(...\n                 │         └ <function handle_upload at 0x000001EE8CE27880>\n                 └ <fastapi.dependencies.models.Dependant object at 0x000001EE8CE814C0>\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 87, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'annavarisudhakar@gmail.com'\n             │              └ './data/Bulk_Download_demofile0190c1cc-49ad-7241-9aa6-ff2b1cf07d96.csv'\n             └ <function run_subprocess at 0x000001EE8CE27600>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 63, in run_subprocess\n    raise Exception(f\"Failed to decode JSON output: {result.stdout}\")\n                                                     │      └ 'Zipping folder\\nSent\\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"p...\n                                                     └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n\nException: Failed to decode JSON output: Zipping folder\nSent\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"pre-signed\": \"https://finkraft-invoices-outstation.s3.amazonaws.com/downloadables/Jul17/20240717231524881597-invoices.zip?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAWVKQBF2L47ZDIG6F%2F20240717%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20240717T174527Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=cd53491567837cc08bbcd8910af2ff774ceb84c4056c2ea2a3553bd34145db67\", \"details\": {\"total\": 34, \"skipped\": {\"Error\": {}}, \"not_existing\": [\"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01AAB3 35.pdf,272412BP01AAB335.pdf,AIR INDIA LTD.,12346\", \"https://airline-engine-scraped.s3.am azonaws.com/v0/WebScraping/airindia/232412BP02AAC1 32.pdf,232412BP02AAC132.pdf,AIR INDIA LTD.,12350\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01ABC 990.pdf,272412BP01ABC990.pdf,AIR INDIA LTD.,12353\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/072412BP01AAK 222.pdf,072412BP01AAK222.pdf,AIR INDIA LTD.,12356\"], \"invalid_access\": [], \"invalid_s3\": []}}\n\n", "record": {"elapsed": {"repr": "0:00:26.092717", "seconds": 26.092717}, "exception": {"type": "Exception", "value": "Failed to decode JSON output: Zipping folder\nSent\n{\"success\": true, \"msg\": \"Successfully downloaded and sent\", \"email\": \"annavarisudhakar@gmail.com\", \"pre-signed\": \"https://finkraft-invoices-outstation.s3.amazonaws.com/downloadables/Jul17/20240717231524881597-invoices.zip?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAWVKQBF2L47ZDIG6F%2F20240717%2Fap-south-1%2Fs3%2Faws4_request&X-Amz-Date=20240717T174527Z&X-Amz-Expires=604800&X-Amz-SignedHeaders=host&X-Amz-Signature=cd53491567837cc08bbcd8910af2ff774ceb84c4056c2ea2a3553bd34145db67\", \"details\": {\"total\": 34, \"skipped\": {\"Error\": {}}, \"not_existing\": [\"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01AAB3 35.pdf,272412BP01AAB335.pdf,AIR INDIA LTD.,12346\", \"https://airline-engine-scraped.s3.am azonaws.com/v0/WebScraping/airindia/232412BP02AAC1 32.pdf,232412BP02AAC132.pdf,AIR INDIA LTD.,12350\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/272412BP01ABC 990.pdf,272412BP01ABC990.pdf,AIR INDIA LTD.,12353\", \"https://airline-engine-scraped.s3.amazonaws.com/v0/WebScraping/airindia/072412BP01AAK 222.pdf,072412BP01AAK222.pdf,AIR INDIA LTD.,12356\"], \"invalid_access\": [], \"invalid_s3\": []}}\n", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 89, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 4684, "name": "MainProcess"}, "thread": {"id": 12256, "name": "MainThread"}, "time": {"repr": "2024-07-17 23:15:31.498764+05:30", "timestamp": 1721238331.498764}}}
{"text": "2024-07-18 17:07:52.871 | ERROR    | __main__:run_subprocess:58 - Subprocess failed with error: 2024-07-18 17:05:53.807 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:05:53.829 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:05:54.912 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n2024-07-18 17:07:52.056 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 174, in _new_conn\n    conn = connection.create_connection(\n           |          -> <function create_connection at 0x00000292940EADE0>\n           -> <module 'urllib3.util.connection' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\ur...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\connection.py\", line 72, in create_connection\n    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):\n               |      |           |     |     |       |      -> <SocketKind.SOCK_STREAM: 1>\n               |      |           |     |     |       -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n               |      |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |      |           |     -> 443\n               |      |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |      -> <function getaddrinfo at 0x0000029291B7D620>\n               -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               |       |           |     |     |       |     |      -> 0\n               |       |           |     |     |       |     -> 0\n               |       |           |     |     |       -> <SocketKind.SOCK_STREAM: 1>\n               |       |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |       |           |     -> 443\n               |       |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |       -> <built-in function getaddrinfo>\n               -> <module '_socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\DLLs\\\\_socket.pyd'>\n\nsocket.gaierror: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 465, in send\n    urllib_response = conn.urlopen(\n                      |    -> <function HTTPConnectionPool.urlopen at 0x000002929416D300>\n                      -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 798, in urlopen\n    retries = retries.increment(\n              |       -> <function Retry.increment at 0x0000029294105080>\n              -> Retry(total=False, connect=None, read=None, redirect=0, status=None)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\retry.py\", line 525, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n          |   |            |       |      -> <traceback object at 0x00000292AEF849C0>\n          |   |            |       -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   |            -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   -> <function reraise at 0x00000292940E8860>\n          -> <module 'urllib3.packages.six' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\urlli...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\packages\\six.py\", line 770, in reraise\n    raise value\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 714, in urlopen\n    httplib_response = self._make_request(\n                       |    -> <function HTTPConnectionPool._make_request at 0x000002929416D080>\n                       -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 403, in _make_request\n    self._validate_conn(conn)\n    |    |              -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> <function HTTPSConnectionPool._validate_conn at 0x000002929416D760>\n    -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 1053, in _validate_conn\n    conn.connect()\n    |    -> <function HTTPSConnection.connect at 0x00000292941227A0>\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 363, in connect\n    self.sock = conn = self._new_conn()\n    |    |             |    -> <function HTTPConnection._new_conn at 0x0000029294122160>\n    |    |             -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> None\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 186, in _new_conn\n    raise NewConnectionError(\n          -> <class 'urllib3.exceptions.NewConnectionError'>\n\nurllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'annavarisudhakar@gmail.com'\n        |              -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c.csv'\n        -> <function process_upload at 0x00000292AC2AE0C0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x00000292AC2ADBC0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n        |         |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/indigo/FCM-05-02-2024/2024-03-05/indigo/T2TW6E-...\n        |         |        |   -> <function download_files.<locals>.fetcher at 0x00000292ACA7BF60>\n        |         |        -> <function Executor.map at 0x00000292947B45E0>\n        |         -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x00000292ACA75700>\n        -> ('./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c', {'Error': {}}, [], [], [], [['https://airline-engine-scraped.s3.ap...\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x292ad808950 state=finished returned tuple>, <Future at 0x292ad7e92e0 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x000002929477FA60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 449, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 179, in fetcher\n    s3.Bucket(bucket).download_file(key, target_name)\n    |  |      |                     |    -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\\\\TATA SIA Airlines Limited\\\\C070000001738050.pdf'\n    |  |      |                     -> 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf'\n    |  |      -> 'airline-engine-scraped'\n    |  -> <function ResourceFactory._create_class_partial.<locals>.create_resource at 0x00000292ACA7B2E0>\n    -> s3.ServiceResource()\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 277, in bucket_download_file\n    return self.meta.client.download_file(\n           |    |    |      -> <function download_file at 0x00000292ACA79BC0>\n           |    |    -> <botocore.client.S3 object at 0x00000292ACE400B0>\n           |    -> ResourceMeta('s3', identifiers=['name'])\n           -> s3.Bucket(name='airline-engine-scraped')\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 190, in download_file\n    return transfer.download_file(\n           |        -> <function S3Transfer.download_file at 0x00000292ACA794E0>\n           -> <boto3.s3.transfer.S3Transfer object at 0x00000292AED23860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\transfer.py\", line 326, in download_file\n    future.result()\n    |      -> <function TransferFuture.result at 0x00000292ACA31F80>\n    -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 103, in result\n    return self._coordinator.result()\n           |    |            -> <function TransferCoordinator.result at 0x00000292ACA32B60>\n           |    -> TransferCoordinator(transfer_id=0)\n           -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 266, in result\n    raise self._exception\n          |    -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n          -> TransferCoordinator(transfer_id=0)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\tasks.py\", line 269, in _main\n    self._submit(transfer_future=transfer_future, **kwargs)\n    |    |                       |                  -> {'client': <botocore.client.S3 object at 0x00000292ACE400B0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x0000029...\n    |    |                       -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n    |    -> <function DownloadSubmissionTask._submit at 0x00000292ACA68D60>\n    -> DownloadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>})\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\download.py\", line 354, in _submit\n    response = client.head_object(\n               |      -> <function ClientCreator._create_api_method.<locals>._api_call at 0x00000292ACC0B880>\n               -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 530, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n           |    |              |               -> {'Bucket': 'airline-engine-scraped', 'Key': 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C07000000...\n           |    |              -> 'HeadObject'\n           |    -> <function BaseClient._make_api_call at 0x00000292943AF240>\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 947, in _make_api_call\n    http, parsed_response = self._make_request(\n                            |    -> <function BaseClient._make_request at 0x00000292943AF2E0>\n                            -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 970, in _make_request\n    return self._endpoint.make_request(operation_model, request_dict)\n           |    |         |            |                -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    |         |            -> OperationModel(name=HeadObject)\n           |    |         -> <function Endpoint.make_request at 0x0000029294319760>\n           |    -> s3(https://s3.ap-south-1.amazonaws.com)\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 119, in make_request\n    return self._send_request(request_dict, operation_model)\n           |    |             |             -> OperationModel(name=HeadObject)\n           |    |             -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    -> <function Endpoint._send_request at 0x0000029294319BC0>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 202, in _send_request\n    while self._needs_retry(\n          |    -> <function Endpoint._needs_retry at 0x0000029294319E40>\n          -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 354, in _needs_retry\n    responses = self._event_emitter.emit(\n                |    |              -> <function EventAliaser.emit at 0x000002929430E700>\n                |    -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n                -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 412, in emit\n    return self._emitter.emit(aliased_event_name, **kwargs)\n           |    |        |    |                     -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |        |    -> 'needs-retry.s3.HeadObject'\n           |    |        -> <function HierarchicalEmitter.emit at 0x000002929430E0C0>\n           |    -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n           -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 256, in emit\n    return self._emit(event_name, kwargs)\n           |    |     |           -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |     -> 'needs-retry.s3.HeadObject'\n           |    -> <function HierarchicalEmitter._emit at 0x000002929430E020>\n           -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 239, in _emit\n    response = handler(**kwargs)\n               |         -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n               -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 207, in __call__\n    if self._checker(**checker_kwargs):\n       |    |          -> {'attempt_number': 5, 'response': None, 'caught_exception': EndpointConnectionError('Could not connect to the endpoint URL: \"...\n       |    -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n       -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 284, in __call__\n    should_retry = self._should_retry(\n                   |    -> <function MaxAttemptsDecorator._should_retry at 0x0000029294422DE0>\n                   -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 320, in _should_retry\n    return self._checker(attempt_number, response, caught_exception)\n           |    |        |               |         -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n           |    |        |               -> None\n           |    |        -> 5\n           |    -> <botocore.retryhandler.MultiChecker object at 0x00000292ACE567B0>\n           -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 363, in __call__\n    checker_response = checker(\n                       -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 247, in __call__\n    return self._check_caught_exception(\n           |    -> <function ExceptionRaiser._check_caught_exception at 0x0000029294423420>\n           -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 416, in _check_caught_exception\n    raise caught_exception\n          -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 281, in _do_get_response\n    http_response = self._send(request)\n                    |    |     -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n                    |    -> <function Endpoint._send at 0x0000029294319EE0>\n                    -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 377, in _send\n    return self.http_session.send(request)\n           |    |            |    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n           |    |            -> <function URLLib3Session.send at 0x000002929426D300>\n           |    -> <botocore.httpsession.URLLib3Session object at 0x00000292ACA37620>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 494, in send\n    raise EndpointConnectionError(endpoint_url=request.url, error=e)\n          |                                    |       -> 'https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_C...\n          |                                    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n          -> <class 'botocore.exceptions.EndpointConnectionError'>\n\nbotocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf\"\n\n", "record": {"elapsed": {"repr": "0:02:33.287927", "seconds": 153.287927}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 58, "message": "Subprocess failed with error: 2024-07-18 17:05:53.807 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:05:53.829 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:05:54.912 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n2024-07-18 17:07:52.056 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 174, in _new_conn\n    conn = connection.create_connection(\n           |          -> <function create_connection at 0x00000292940EADE0>\n           -> <module 'urllib3.util.connection' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\ur...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\connection.py\", line 72, in create_connection\n    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):\n               |      |           |     |     |       |      -> <SocketKind.SOCK_STREAM: 1>\n               |      |           |     |     |       -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n               |      |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |      |           |     -> 443\n               |      |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |      -> <function getaddrinfo at 0x0000029291B7D620>\n               -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               |       |           |     |     |       |     |      -> 0\n               |       |           |     |     |       |     -> 0\n               |       |           |     |     |       -> <SocketKind.SOCK_STREAM: 1>\n               |       |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |       |           |     -> 443\n               |       |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |       -> <built-in function getaddrinfo>\n               -> <module '_socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\DLLs\\\\_socket.pyd'>\n\nsocket.gaierror: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 465, in send\n    urllib_response = conn.urlopen(\n                      |    -> <function HTTPConnectionPool.urlopen at 0x000002929416D300>\n                      -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 798, in urlopen\n    retries = retries.increment(\n              |       -> <function Retry.increment at 0x0000029294105080>\n              -> Retry(total=False, connect=None, read=None, redirect=0, status=None)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\retry.py\", line 525, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n          |   |            |       |      -> <traceback object at 0x00000292AEF849C0>\n          |   |            |       -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   |            -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   -> <function reraise at 0x00000292940E8860>\n          -> <module 'urllib3.packages.six' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\urlli...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\packages\\six.py\", line 770, in reraise\n    raise value\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 714, in urlopen\n    httplib_response = self._make_request(\n                       |    -> <function HTTPConnectionPool._make_request at 0x000002929416D080>\n                       -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 403, in _make_request\n    self._validate_conn(conn)\n    |    |              -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> <function HTTPSConnectionPool._validate_conn at 0x000002929416D760>\n    -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 1053, in _validate_conn\n    conn.connect()\n    |    -> <function HTTPSConnection.connect at 0x00000292941227A0>\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 363, in connect\n    self.sock = conn = self._new_conn()\n    |    |             |    -> <function HTTPConnection._new_conn at 0x0000029294122160>\n    |    |             -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> None\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 186, in _new_conn\n    raise NewConnectionError(\n          -> <class 'urllib3.exceptions.NewConnectionError'>\n\nurllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'annavarisudhakar@gmail.com'\n        |              -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c.csv'\n        -> <function process_upload at 0x00000292AC2AE0C0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x00000292AC2ADBC0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n        |         |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/indigo/FCM-05-02-2024/2024-03-05/indigo/T2TW6E-...\n        |         |        |   -> <function download_files.<locals>.fetcher at 0x00000292ACA7BF60>\n        |         |        -> <function Executor.map at 0x00000292947B45E0>\n        |         -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x00000292ACA75700>\n        -> ('./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c', {'Error': {}}, [], [], [], [['https://airline-engine-scraped.s3.ap...\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x292ad808950 state=finished returned tuple>, <Future at 0x292ad7e92e0 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x000002929477FA60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 449, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 179, in fetcher\n    s3.Bucket(bucket).download_file(key, target_name)\n    |  |      |                     |    -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\\\\TATA SIA Airlines Limited\\\\C070000001738050.pdf'\n    |  |      |                     -> 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf'\n    |  |      -> 'airline-engine-scraped'\n    |  -> <function ResourceFactory._create_class_partial.<locals>.create_resource at 0x00000292ACA7B2E0>\n    -> s3.ServiceResource()\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 277, in bucket_download_file\n    return self.meta.client.download_file(\n           |    |    |      -> <function download_file at 0x00000292ACA79BC0>\n           |    |    -> <botocore.client.S3 object at 0x00000292ACE400B0>\n           |    -> ResourceMeta('s3', identifiers=['name'])\n           -> s3.Bucket(name='airline-engine-scraped')\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 190, in download_file\n    return transfer.download_file(\n           |        -> <function S3Transfer.download_file at 0x00000292ACA794E0>\n           -> <boto3.s3.transfer.S3Transfer object at 0x00000292AED23860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\transfer.py\", line 326, in download_file\n    future.result()\n    |      -> <function TransferFuture.result at 0x00000292ACA31F80>\n    -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 103, in result\n    return self._coordinator.result()\n           |    |            -> <function TransferCoordinator.result at 0x00000292ACA32B60>\n           |    -> TransferCoordinator(transfer_id=0)\n           -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 266, in result\n    raise self._exception\n          |    -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n          -> TransferCoordinator(transfer_id=0)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\tasks.py\", line 269, in _main\n    self._submit(transfer_future=transfer_future, **kwargs)\n    |    |                       |                  -> {'client': <botocore.client.S3 object at 0x00000292ACE400B0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x0000029...\n    |    |                       -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n    |    -> <function DownloadSubmissionTask._submit at 0x00000292ACA68D60>\n    -> DownloadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>})\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\download.py\", line 354, in _submit\n    response = client.head_object(\n               |      -> <function ClientCreator._create_api_method.<locals>._api_call at 0x00000292ACC0B880>\n               -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 530, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n           |    |              |               -> {'Bucket': 'airline-engine-scraped', 'Key': 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C07000000...\n           |    |              -> 'HeadObject'\n           |    -> <function BaseClient._make_api_call at 0x00000292943AF240>\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 947, in _make_api_call\n    http, parsed_response = self._make_request(\n                            |    -> <function BaseClient._make_request at 0x00000292943AF2E0>\n                            -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 970, in _make_request\n    return self._endpoint.make_request(operation_model, request_dict)\n           |    |         |            |                -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    |         |            -> OperationModel(name=HeadObject)\n           |    |         -> <function Endpoint.make_request at 0x0000029294319760>\n           |    -> s3(https://s3.ap-south-1.amazonaws.com)\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 119, in make_request\n    return self._send_request(request_dict, operation_model)\n           |    |             |             -> OperationModel(name=HeadObject)\n           |    |             -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    -> <function Endpoint._send_request at 0x0000029294319BC0>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 202, in _send_request\n    while self._needs_retry(\n          |    -> <function Endpoint._needs_retry at 0x0000029294319E40>\n          -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 354, in _needs_retry\n    responses = self._event_emitter.emit(\n                |    |              -> <function EventAliaser.emit at 0x000002929430E700>\n                |    -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n                -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 412, in emit\n    return self._emitter.emit(aliased_event_name, **kwargs)\n           |    |        |    |                     -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |        |    -> 'needs-retry.s3.HeadObject'\n           |    |        -> <function HierarchicalEmitter.emit at 0x000002929430E0C0>\n           |    -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n           -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 256, in emit\n    return self._emit(event_name, kwargs)\n           |    |     |           -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |     -> 'needs-retry.s3.HeadObject'\n           |    -> <function HierarchicalEmitter._emit at 0x000002929430E020>\n           -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 239, in _emit\n    response = handler(**kwargs)\n               |         -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n               -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 207, in __call__\n    if self._checker(**checker_kwargs):\n       |    |          -> {'attempt_number': 5, 'response': None, 'caught_exception': EndpointConnectionError('Could not connect to the endpoint URL: \"...\n       |    -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n       -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 284, in __call__\n    should_retry = self._should_retry(\n                   |    -> <function MaxAttemptsDecorator._should_retry at 0x0000029294422DE0>\n                   -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 320, in _should_retry\n    return self._checker(attempt_number, response, caught_exception)\n           |    |        |               |         -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n           |    |        |               -> None\n           |    |        -> 5\n           |    -> <botocore.retryhandler.MultiChecker object at 0x00000292ACE567B0>\n           -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 363, in __call__\n    checker_response = checker(\n                       -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 247, in __call__\n    return self._check_caught_exception(\n           |    -> <function ExceptionRaiser._check_caught_exception at 0x0000029294423420>\n           -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 416, in _check_caught_exception\n    raise caught_exception\n          -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 281, in _do_get_response\n    http_response = self._send(request)\n                    |    |     -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n                    |    -> <function Endpoint._send at 0x0000029294319EE0>\n                    -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 377, in _send\n    return self.http_session.send(request)\n           |    |            |    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n           |    |            -> <function URLLib3Session.send at 0x000002929426D300>\n           |    -> <botocore.httpsession.URLLib3Session object at 0x00000292ACA37620>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 494, in send\n    raise EndpointConnectionError(endpoint_url=request.url, error=e)\n          |                                    |       -> 'https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_C...\n          |                                    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n          -> <class 'botocore.exceptions.EndpointConnectionError'>\n\nbotocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf\"\n", "module": "win", "name": "__main__", "process": {"id": 1728, "name": "MainProcess"}, "thread": {"id": 5148, "name": "MainThread"}, "time": {"repr": "2024-07-18 17:07:52.871692+05:30", "timestamp": 1721302672.871692}}}
{"text": "2024-07-18 17:07:52.927 | ERROR    | __main__:handle_upload:108 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 115, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x00000280BD1D4DD0>\n    │       └ <function run at 0x00000280BD503880>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x00000280BD542340>\n    └ <uvicorn.server.Server object at 0x00000280BD535730>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x00000280BD5423E0>\n           │       │   └ <uvicorn.server.Server object at 0x00000280BD535730>\n           │       └ <function run at 0x00000280BB016CA0>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x00000280BD5C1D20>\n           │      └ <function Runner.run at 0x00000280BB041F80>\n           └ <asyncio.runners.Runner object at 0x00000280BD5A9910>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000280BB03FBA0>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x00000280BD5A9910>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x00000280BB0F76A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x00000280BB041940>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x00000280BABBDB20>\n    └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000280BD5AA720>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000280BD...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x00000280BD1D4DD0>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000280BD5AA720>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000280BD...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000280BD...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000280BD55CE60>\n          └ <fastapi.applications.FastAPI object at 0x00000280BD1D4DD0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000280BD631580>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x00000280BD493590>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000280BD55CE60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'localhost:5000', 'connection': 'keep-alive', 'content-length': '1080291', 'sec-ch-ua': '\"Not/A)Brand\";v=\"8\"...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000280BD631580>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x00000280BD308360>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000280BD493590>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000280BD493590...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000280BB322FF0>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000280BD493590>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000280BD493590...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x00000280BD664AA0>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x00000280BD5A8F50>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000280BB322FF0>\n          └ <function wrap_app_handling_exceptions at 0x00000280BD226520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65C720>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x00000280BD5A8F50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65C720>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000280BD5A8F50>>\n          └ <fastapi.routing.APIRouter object at 0x00000280BD5A8F50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65C720>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x00000280BD2279C0>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65C720>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x00000280BD5B5300>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65C720>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x00000280BD26FB30>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000280BD65C9A0>\n          └ <function wrap_app_handling_exceptions at 0x00000280BD226520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000280BD65CAE0>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000028...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x00000280BD65C9A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x00000280BD26FB30>\n                     └ <function get_request_handler.<locals>.app at 0x00000280BD5B5260>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x00000280BD225D00>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'annavarisudhakar@gmail.com', 'file': UploadFile(filename='Bulk Cust 2.csv', size=1079884, headers=Headers({'conten...\n                 │         └ <function handle_upload at 0x00000280BD557920>\n                 └ <fastapi.dependencies.models.Dependant object at 0x00000280BD55CDD0>\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 106, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'annavarisudhakar@gmail.com'\n             │              └ './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c.csv'\n             └ <function run_subprocess at 0x00000280BD5576A0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 59, in run_subprocess\n    raise Exception(result.stderr)\n                    │      └ '2024-07-18 17:05:53.807 | INFO     | app.process:process_upload:384 - Processing file\\n2024-07-18 17:05:53.808 | INFO     | ...\n                    └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n\nException: 2024-07-18 17:05:53.807 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:05:53.829 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:05:54.912 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n2024-07-18 17:07:52.056 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 174, in _new_conn\n    conn = connection.create_connection(\n           |          -> <function create_connection at 0x00000292940EADE0>\n           -> <module 'urllib3.util.connection' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\ur...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\connection.py\", line 72, in create_connection\n    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):\n               |      |           |     |     |       |      -> <SocketKind.SOCK_STREAM: 1>\n               |      |           |     |     |       -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n               |      |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |      |           |     -> 443\n               |      |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |      -> <function getaddrinfo at 0x0000029291B7D620>\n               -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               |       |           |     |     |       |     |      -> 0\n               |       |           |     |     |       |     -> 0\n               |       |           |     |     |       -> <SocketKind.SOCK_STREAM: 1>\n               |       |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |       |           |     -> 443\n               |       |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |       -> <built-in function getaddrinfo>\n               -> <module '_socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\DLLs\\\\_socket.pyd'>\n\nsocket.gaierror: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 465, in send\n    urllib_response = conn.urlopen(\n                      |    -> <function HTTPConnectionPool.urlopen at 0x000002929416D300>\n                      -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 798, in urlopen\n    retries = retries.increment(\n              |       -> <function Retry.increment at 0x0000029294105080>\n              -> Retry(total=False, connect=None, read=None, redirect=0, status=None)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\retry.py\", line 525, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n          |   |            |       |      -> <traceback object at 0x00000292AEF849C0>\n          |   |            |       -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   |            -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   -> <function reraise at 0x00000292940E8860>\n          -> <module 'urllib3.packages.six' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\urlli...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\packages\\six.py\", line 770, in reraise\n    raise value\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 714, in urlopen\n    httplib_response = self._make_request(\n                       |    -> <function HTTPConnectionPool._make_request at 0x000002929416D080>\n                       -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 403, in _make_request\n    self._validate_conn(conn)\n    |    |              -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> <function HTTPSConnectionPool._validate_conn at 0x000002929416D760>\n    -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 1053, in _validate_conn\n    conn.connect()\n    |    -> <function HTTPSConnection.connect at 0x00000292941227A0>\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 363, in connect\n    self.sock = conn = self._new_conn()\n    |    |             |    -> <function HTTPConnection._new_conn at 0x0000029294122160>\n    |    |             -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> None\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 186, in _new_conn\n    raise NewConnectionError(\n          -> <class 'urllib3.exceptions.NewConnectionError'>\n\nurllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'annavarisudhakar@gmail.com'\n        |              -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c.csv'\n        -> <function process_upload at 0x00000292AC2AE0C0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x00000292AC2ADBC0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n        |         |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/indigo/FCM-05-02-2024/2024-03-05/indigo/T2TW6E-...\n        |         |        |   -> <function download_files.<locals>.fetcher at 0x00000292ACA7BF60>\n        |         |        -> <function Executor.map at 0x00000292947B45E0>\n        |         -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x00000292ACA75700>\n        -> ('./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c', {'Error': {}}, [], [], [], [['https://airline-engine-scraped.s3.ap...\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x292ad808950 state=finished returned tuple>, <Future at 0x292ad7e92e0 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x000002929477FA60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 449, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 179, in fetcher\n    s3.Bucket(bucket).download_file(key, target_name)\n    |  |      |                     |    -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\\\\TATA SIA Airlines Limited\\\\C070000001738050.pdf'\n    |  |      |                     -> 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf'\n    |  |      -> 'airline-engine-scraped'\n    |  -> <function ResourceFactory._create_class_partial.<locals>.create_resource at 0x00000292ACA7B2E0>\n    -> s3.ServiceResource()\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 277, in bucket_download_file\n    return self.meta.client.download_file(\n           |    |    |      -> <function download_file at 0x00000292ACA79BC0>\n           |    |    -> <botocore.client.S3 object at 0x00000292ACE400B0>\n           |    -> ResourceMeta('s3', identifiers=['name'])\n           -> s3.Bucket(name='airline-engine-scraped')\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 190, in download_file\n    return transfer.download_file(\n           |        -> <function S3Transfer.download_file at 0x00000292ACA794E0>\n           -> <boto3.s3.transfer.S3Transfer object at 0x00000292AED23860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\transfer.py\", line 326, in download_file\n    future.result()\n    |      -> <function TransferFuture.result at 0x00000292ACA31F80>\n    -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 103, in result\n    return self._coordinator.result()\n           |    |            -> <function TransferCoordinator.result at 0x00000292ACA32B60>\n           |    -> TransferCoordinator(transfer_id=0)\n           -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 266, in result\n    raise self._exception\n          |    -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n          -> TransferCoordinator(transfer_id=0)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\tasks.py\", line 269, in _main\n    self._submit(transfer_future=transfer_future, **kwargs)\n    |    |                       |                  -> {'client': <botocore.client.S3 object at 0x00000292ACE400B0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x0000029...\n    |    |                       -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n    |    -> <function DownloadSubmissionTask._submit at 0x00000292ACA68D60>\n    -> DownloadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>})\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\download.py\", line 354, in _submit\n    response = client.head_object(\n               |      -> <function ClientCreator._create_api_method.<locals>._api_call at 0x00000292ACC0B880>\n               -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 530, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n           |    |              |               -> {'Bucket': 'airline-engine-scraped', 'Key': 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C07000000...\n           |    |              -> 'HeadObject'\n           |    -> <function BaseClient._make_api_call at 0x00000292943AF240>\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 947, in _make_api_call\n    http, parsed_response = self._make_request(\n                            |    -> <function BaseClient._make_request at 0x00000292943AF2E0>\n                            -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 970, in _make_request\n    return self._endpoint.make_request(operation_model, request_dict)\n           |    |         |            |                -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    |         |            -> OperationModel(name=HeadObject)\n           |    |         -> <function Endpoint.make_request at 0x0000029294319760>\n           |    -> s3(https://s3.ap-south-1.amazonaws.com)\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 119, in make_request\n    return self._send_request(request_dict, operation_model)\n           |    |             |             -> OperationModel(name=HeadObject)\n           |    |             -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    -> <function Endpoint._send_request at 0x0000029294319BC0>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 202, in _send_request\n    while self._needs_retry(\n          |    -> <function Endpoint._needs_retry at 0x0000029294319E40>\n          -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 354, in _needs_retry\n    responses = self._event_emitter.emit(\n                |    |              -> <function EventAliaser.emit at 0x000002929430E700>\n                |    -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n                -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 412, in emit\n    return self._emitter.emit(aliased_event_name, **kwargs)\n           |    |        |    |                     -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |        |    -> 'needs-retry.s3.HeadObject'\n           |    |        -> <function HierarchicalEmitter.emit at 0x000002929430E0C0>\n           |    -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n           -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 256, in emit\n    return self._emit(event_name, kwargs)\n           |    |     |           -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |     -> 'needs-retry.s3.HeadObject'\n           |    -> <function HierarchicalEmitter._emit at 0x000002929430E020>\n           -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 239, in _emit\n    response = handler(**kwargs)\n               |         -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n               -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 207, in __call__\n    if self._checker(**checker_kwargs):\n       |    |          -> {'attempt_number': 5, 'response': None, 'caught_exception': EndpointConnectionError('Could not connect to the endpoint URL: \"...\n       |    -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n       -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 284, in __call__\n    should_retry = self._should_retry(\n                   |    -> <function MaxAttemptsDecorator._should_retry at 0x0000029294422DE0>\n                   -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 320, in _should_retry\n    return self._checker(attempt_number, response, caught_exception)\n           |    |        |               |         -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n           |    |        |               -> None\n           |    |        -> 5\n           |    -> <botocore.retryhandler.MultiChecker object at 0x00000292ACE567B0>\n           -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 363, in __call__\n    checker_response = checker(\n                       -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 247, in __call__\n    return self._check_caught_exception(\n           |    -> <function ExceptionRaiser._check_caught_exception at 0x0000029294423420>\n           -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 416, in _check_caught_exception\n    raise caught_exception\n          -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 281, in _do_get_response\n    http_response = self._send(request)\n                    |    |     -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n                    |    -> <function Endpoint._send at 0x0000029294319EE0>\n                    -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 377, in _send\n    return self.http_session.send(request)\n           |    |            |    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n           |    |            -> <function URLLib3Session.send at 0x000002929426D300>\n           |    -> <botocore.httpsession.URLLib3Session object at 0x00000292ACA37620>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 494, in send\n    raise EndpointConnectionError(endpoint_url=request.url, error=e)\n          |                                    |       -> 'https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_C...\n          |                                    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n          -> <class 'botocore.exceptions.EndpointConnectionError'>\n\nbotocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf\"\n\n", "record": {"elapsed": {"repr": "0:02:33.343572", "seconds": 153.343572}, "exception": {"type": "Exception", "value": "2024-07-18 17:05:53.807 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\n2024-07-18 17:05:53.808 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:05:53.829 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:05:54.912 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n2024-07-18 17:07:52.056 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 174, in _new_conn\n    conn = connection.create_connection(\n           |          -> <function create_connection at 0x00000292940EADE0>\n           -> <module 'urllib3.util.connection' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\ur...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\connection.py\", line 72, in create_connection\n    for res in socket.getaddrinfo(host, port, family, socket.SOCK_STREAM):\n               |      |           |     |     |       |      -> <SocketKind.SOCK_STREAM: 1>\n               |      |           |     |     |       -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n               |      |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |      |           |     -> 443\n               |      |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |      -> <function getaddrinfo at 0x0000029291B7D620>\n               -> <module 'socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\socket.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               |       |           |     |     |       |     |      -> 0\n               |       |           |     |     |       |     -> 0\n               |       |           |     |     |       -> <SocketKind.SOCK_STREAM: 1>\n               |       |           |     |     -> <AddressFamily.AF_UNSPEC: 0>\n               |       |           |     -> 443\n               |       |           -> 'airline-engine-scraped.s3.ap-south-1.amazonaws.com'\n               |       -> <built-in function getaddrinfo>\n               -> <module '_socket' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\DLLs\\\\_socket.pyd'>\n\nsocket.gaierror: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 465, in send\n    urllib_response = conn.urlopen(\n                      |    -> <function HTTPConnectionPool.urlopen at 0x000002929416D300>\n                      -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 798, in urlopen\n    retries = retries.increment(\n              |       -> <function Retry.increment at 0x0000029294105080>\n              -> Retry(total=False, connect=None, read=None, redirect=0, status=None)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\util\\retry.py\", line 525, in increment\n    raise six.reraise(type(error), error, _stacktrace)\n          |   |            |       |      -> <traceback object at 0x00000292AEF849C0>\n          |   |            |       -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   |            -> NewConnectionError('<botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connecti...\n          |   -> <function reraise at 0x00000292940E8860>\n          -> <module 'urllib3.packages.six' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\urlli...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\packages\\six.py\", line 770, in reraise\n    raise value\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 714, in urlopen\n    httplib_response = self._make_request(\n                       |    -> <function HTTPConnectionPool._make_request at 0x000002929416D080>\n                       -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 403, in _make_request\n    self._validate_conn(conn)\n    |    |              -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> <function HTTPSConnectionPool._validate_conn at 0x000002929416D760>\n    -> <botocore.awsrequest.AWSHTTPSConnectionPool object at 0x00000292ACEE4830>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connectionpool.py\", line 1053, in _validate_conn\n    conn.connect()\n    |    -> <function HTTPSConnection.connect at 0x00000292941227A0>\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 363, in connect\n    self.sock = conn = self._new_conn()\n    |    |             |    -> <function HTTPConnection._new_conn at 0x0000029294122160>\n    |    |             -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n    |    -> None\n    -> <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\urllib3\\connection.py\", line 186, in _new_conn\n    raise NewConnectionError(\n          -> <class 'urllib3.exceptions.NewConnectionError'>\n\nurllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPSConnection object at 0x00000292AF305FA0>: Failed to establish a new connection: [Errno 11001] getaddrinfo failed\n\n\nDuring handling of the above exception, another exception occurred:\n\n\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'annavarisudhakar@gmail.com'\n        |              -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c.csv'\n        -> <function process_upload at 0x00000292AC2AE0C0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x00000292AC2ADBC0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n        |         |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/indigo/FCM-05-02-2024/2024-03-05/indigo/T2TW6E-...\n        |         |        |   -> <function download_files.<locals>.fetcher at 0x00000292ACA7BF60>\n        |         |        -> <function Executor.map at 0x00000292947B45E0>\n        |         -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x00000292ACA75700>\n        -> ('./data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c', {'Error': {}}, [], [], [], [['https://airline-engine-scraped.s3.ap...\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x292ad808950 state=finished returned tuple>, <Future at 0x292ad7e92e0 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x000002929477FA60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 449, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py\", line 179, in fetcher\n    s3.Bucket(bucket).download_file(key, target_name)\n    |  |      |                     |    -> './data/Bulk Cust 20190c5a0-8820-7717-a169-2ef66150983c\\\\TATA SIA Airlines Limited\\\\C070000001738050.pdf'\n    |  |      |                     -> 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf'\n    |  |      -> 'airline-engine-scraped'\n    |  -> <function ResourceFactory._create_class_partial.<locals>.create_resource at 0x00000292ACA7B2E0>\n    -> s3.ServiceResource()\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 277, in bucket_download_file\n    return self.meta.client.download_file(\n           |    |    |      -> <function download_file at 0x00000292ACA79BC0>\n           |    |    -> <botocore.client.S3 object at 0x00000292ACE400B0>\n           |    -> ResourceMeta('s3', identifiers=['name'])\n           -> s3.Bucket(name='airline-engine-scraped')\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\inject.py\", line 190, in download_file\n    return transfer.download_file(\n           |        -> <function S3Transfer.download_file at 0x00000292ACA794E0>\n           -> <boto3.s3.transfer.S3Transfer object at 0x00000292AED23860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\boto3\\s3\\transfer.py\", line 326, in download_file\n    future.result()\n    |      -> <function TransferFuture.result at 0x00000292ACA31F80>\n    -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 103, in result\n    return self._coordinator.result()\n           |    |            -> <function TransferCoordinator.result at 0x00000292ACA32B60>\n           |    -> TransferCoordinator(transfer_id=0)\n           -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\futures.py\", line 266, in result\n    raise self._exception\n          |    -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n          -> TransferCoordinator(transfer_id=0)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\tasks.py\", line 269, in _main\n    self._submit(transfer_future=transfer_future, **kwargs)\n    |    |                       |                  -> {'client': <botocore.client.S3 object at 0x00000292ACE400B0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x0000029...\n    |    |                       -> <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>\n    |    -> <function DownloadSubmissionTask._submit at 0x00000292ACA68D60>\n    -> DownloadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x00000292AED22EA0>})\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\s3transfer\\download.py\", line 354, in _submit\n    response = client.head_object(\n               |      -> <function ClientCreator._create_api_method.<locals>._api_call at 0x00000292ACC0B880>\n               -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 530, in _api_call\n    return self._make_api_call(operation_name, kwargs)\n           |    |              |               -> {'Bucket': 'airline-engine-scraped', 'Key': 'v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C07000000...\n           |    |              -> 'HeadObject'\n           |    -> <function BaseClient._make_api_call at 0x00000292943AF240>\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 947, in _make_api_call\n    http, parsed_response = self._make_request(\n                            |    -> <function BaseClient._make_request at 0x00000292943AF2E0>\n                            -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\client.py\", line 970, in _make_request\n    return self._endpoint.make_request(operation_model, request_dict)\n           |    |         |            |                -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    |         |            -> OperationModel(name=HeadObject)\n           |    |         -> <function Endpoint.make_request at 0x0000029294319760>\n           |    -> s3(https://s3.ap-south-1.amazonaws.com)\n           -> <botocore.client.S3 object at 0x00000292ACE400B0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 119, in make_request\n    return self._send_request(request_dict, operation_model)\n           |    |             |             -> OperationModel(name=HeadObject)\n           |    |             -> {'url_path': '/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf', 'quer...\n           |    -> <function Endpoint._send_request at 0x0000029294319BC0>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 202, in _send_request\n    while self._needs_retry(\n          |    -> <function Endpoint._needs_retry at 0x0000029294319E40>\n          -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 354, in _needs_retry\n    responses = self._event_emitter.emit(\n                |    |              -> <function EventAliaser.emit at 0x000002929430E700>\n                |    -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n                -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 412, in emit\n    return self._emitter.emit(aliased_event_name, **kwargs)\n           |    |        |    |                     -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |        |    -> 'needs-retry.s3.HeadObject'\n           |    |        -> <function HierarchicalEmitter.emit at 0x000002929430E0C0>\n           |    -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n           -> <botocore.hooks.EventAliaser object at 0x00000292ACE17860>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 256, in emit\n    return self._emit(event_name, kwargs)\n           |    |     |           -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n           |    |     -> 'needs-retry.s3.HeadObject'\n           |    -> <function HierarchicalEmitter._emit at 0x000002929430E020>\n           -> <botocore.hooks.HierarchicalEmitter object at 0x00000292ABF44D70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\hooks.py\", line 239, in _emit\n    response = handler(**kwargs)\n               |         -> {'response': None, 'endpoint': s3(https://s3.ap-south-1.amazonaws.com), 'operation': OperationModel(name=HeadObject), 'attemp...\n               -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 207, in __call__\n    if self._checker(**checker_kwargs):\n       |    |          -> {'attempt_number': 5, 'response': None, 'caught_exception': EndpointConnectionError('Could not connect to the endpoint URL: \"...\n       |    -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n       -> <botocore.retryhandler.RetryHandler object at 0x00000292ACE56810>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 284, in __call__\n    should_retry = self._should_retry(\n                   |    -> <function MaxAttemptsDecorator._should_retry at 0x0000029294422DE0>\n                   -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 320, in _should_retry\n    return self._checker(attempt_number, response, caught_exception)\n           |    |        |               |         -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n           |    |        |               -> None\n           |    |        -> 5\n           |    -> <botocore.retryhandler.MultiChecker object at 0x00000292ACE567B0>\n           -> <botocore.retryhandler.MaxAttemptsDecorator object at 0x00000292ACE567E0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 363, in __call__\n    checker_response = checker(\n                       -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 247, in __call__\n    return self._check_caught_exception(\n           |    -> <function ExceptionRaiser._check_caught_exception at 0x0000029294423420>\n           -> <botocore.retryhandler.ExceptionRaiser object at 0x00000292ACA759A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\retryhandler.py\", line 416, in _check_caught_exception\n    raise caught_exception\n          -> EndpointConnectionError('Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 281, in _do_get_response\n    http_response = self._send(request)\n                    |    |     -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n                    |    -> <function Endpoint._send at 0x0000029294319EE0>\n                    -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\endpoint.py\", line 377, in _send\n    return self.http_session.send(request)\n           |    |            |    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n           |    |            -> <function URLLib3Session.send at 0x000002929426D300>\n           |    -> <botocore.httpsession.URLLib3Session object at 0x00000292ACA37620>\n           -> s3(https://s3.ap-south-1.amazonaws.com)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\botocore\\httpsession.py\", line 494, in send\n    raise EndpointConnectionError(endpoint_url=request.url, error=e)\n          |                                    |       -> 'https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_C...\n          |                                    -> <AWSPreparedRequest stream_output=False, method=HEAD, url=https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manua...\n          -> <class 'botocore.exceptions.EndpointConnectionError'>\n\nbotocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: \"https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_10-02-2024/GST_INVOICE_2146495.zip/GST_CREDIT_C070000001738050_2146495_11.pdf\"\n", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 108, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 1728, "name": "MainProcess"}, "thread": {"id": 5148, "name": "MainThread"}, "time": {"repr": "2024-07-18 17:07:52.927337+05:30", "timestamp": 1721302672.927337}}}
{"text": "2024-07-18 17:12:27.441 | ERROR    | __main__:run_subprocess:58 - Subprocess failed with error: 2024-07-18 17:12:19.109 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:12:19.109 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a6-6c5d-7e0b-a581-43e3dc609462\n2024-07-18 17:12:19.110 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:12:19.137 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:12:19.665 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n\n", "record": {"elapsed": {"repr": "0:00:32.889181", "seconds": 32.889181}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 58, "message": "Subprocess failed with error: 2024-07-18 17:12:19.109 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:12:19.109 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a6-6c5d-7e0b-a581-43e3dc609462\n2024-07-18 17:12:19.110 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:12:19.137 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:12:19.665 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n", "module": "win", "name": "__main__", "process": {"id": 7212, "name": "MainProcess"}, "thread": {"id": 19616, "name": "MainThread"}, "time": {"repr": "2024-07-18 17:12:27.441583+05:30", "timestamp": 1721302947.441583}}}
{"text": "2024-07-18 17:12:27.444 | ERROR    | __main__:handle_upload:108 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 115, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x00000243D7FAB200>\n    │       └ <function run at 0x00000243DA3E3880>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x00000243DA422340>\n    └ <uvicorn.server.Server object at 0x00000243DA489EE0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x00000243DA4223E0>\n           │       │   └ <uvicorn.server.Server object at 0x00000243DA489EE0>\n           │       └ <function run at 0x00000243D7EF6CA0>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x00000243DA4A1D20>\n           │      └ <function Runner.run at 0x00000243D7F21F80>\n           └ <asyncio.runners.Runner object at 0x00000243DA489D60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000243D7F1FBA0>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x00000243DA489D60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x00000243D7FD76A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x00000243D7F21940>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x00000243D7A9DB20>\n    └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finis...1718E2ZO\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000243DA3EF770>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000243DA...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x00000243D7FAB200>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000243DA3EF770>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000243DA...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x00000243DA...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000243DA2AA9C0>\n          └ <fastapi.applications.FastAPI object at 0x00000243D7FAB200>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000243DA53C720>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x00000243DA48AED0>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x00000243DA2AA9C0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'localhost:5000', 'connection': 'keep-alive', 'content-length': '1080291', 'sec-ch-ua': '\"Not/A)Brand\";v=\"8\"...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x00000243DA53C720>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x00000243DA1E4360>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000243DA48AED0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000243DA48AED0...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000243DA48A720>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x00000243DA48AED0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x00000243DA48AED0...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x00000243DA540B30>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x00000243DA3A3530>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x00000243DA48A720>\n          └ <function wrap_app_handling_exceptions at 0x00000243DA106520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53C9A0>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x00000243DA3A3530>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53C9A0>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x00000243DA3A3530>>\n          └ <fastapi.routing.APIRouter object at 0x00000243DA3A3530>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53C9A0>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x00000243DA1079C0>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53C9A0>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x00000243DA495300>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53C9A0>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x00000243DA1DA900>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x00000243DA53CA40>\n          └ <function wrap_app_handling_exceptions at 0x00000243DA106520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x00000243DA53CB80>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000024...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x00000243DA53CA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x00000243DA1DA900>\n                     └ <function get_request_handler.<locals>.app at 0x00000243DA495260>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x00000243DA105D00>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'annavarisudhakar@gmail.com', 'file': UploadFile(filename='Bulk Cust 2.csv', size=1079884, headers=Headers({'conten...\n                 │         └ <function handle_upload at 0x00000243DA437920>\n                 └ <fastapi.dependencies.models.Dependant object at 0x00000243DA4159D0>\n\n> File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 106, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'annavarisudhakar@gmail.com'\n             │              └ './data/Bulk Cust 20190c5a6-6c5d-7e0b-a581-43e3dc609462.csv'\n             └ <function run_subprocess at 0x00000243DA4376A0>\n\n  File \"C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py\", line 59, in run_subprocess\n    raise Exception(result.stderr)\n                    │      └ '2024-07-18 17:12:19.109 | INFO     | app.process:process_upload:384 - Processing file\\n2024-07-18 17:12:19.109 | INFO     | ...\n                    └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n\nException: 2024-07-18 17:12:19.109 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:12:19.109 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a6-6c5d-7e0b-a581-43e3dc609462\n2024-07-18 17:12:19.110 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:12:19.137 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:12:19.665 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n\n", "record": {"elapsed": {"repr": "0:00:32.891670", "seconds": 32.89167}, "exception": {"type": "Exception", "value": "2024-07-18 17:12:19.109 | INFO     | app.process:process_upload:384 - Processing file\n2024-07-18 17:12:19.109 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk Cust 20190c5a6-6c5d-7e0b-a581-43e3dc609462\n2024-07-18 17:12:19.110 | INFO     | app.process:download_files:123 - Reading file\n2024-07-18 17:12:19.137 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-07-18 17:12:19.665 | INFO     | app.process:download_files:148 - Dividing into workers :: 29 for total :: 5784\n", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 108, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 7212, "name": "MainProcess"}, "thread": {"id": 19616, "name": "MainThread"}, "time": {"repr": "2024-07-18 17:12:27.444072+05:30", "timestamp": 1721302947.444072}}}
{"text": "2024-07-31 16:04:33.503 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:02:21.829193", "seconds": 141.829193}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 20836, "name": "MainProcess"}, "thread": {"id": 9900, "name": "AnyIO worker thread"}, "time": {"repr": "2024-07-31 16:04:33.503434+05:30", "timestamp": 1722422073.503434}}}
{"text": "2024-08-01 16:02:41.191 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:01:36.034062", "seconds": 96.034062}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 23040, "name": "MainProcess"}, "thread": {"id": 20020, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 16:02:41.191733+05:30", "timestamp": 1722508361.191733}}}
{"text": "2024-08-01 16:18:56.092 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:17:50.934495", "seconds": 1070.934495}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 23040, "name": "MainProcess"}, "thread": {"id": 20020, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 16:18:56.092166+05:30", "timestamp": 1722509336.092166}}}
{"text": "2024-08-01 16:38:43.742 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:04:13.539386", "seconds": 253.539386}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 16:38:43.742367+05:30", "timestamp": 1722510523.742367}}}
{"text": "2024-08-01 16:50:32.829 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:16:02.626715", "seconds": 962.626715}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 16:50:32.829696+05:30", "timestamp": 1722511232.829696}}}
{"text": "2024-08-01 17:00:06.089 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:25:35.886103", "seconds": 1535.886103}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 17:00:06.089084+05:30", "timestamp": 1722511806.089084}}}
{"text": "2024-08-01 17:08:11.268 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:33:41.066000", "seconds": 2021.066}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 17:08:11.268981+05:30", "timestamp": 1722512291.268981}}}
{"text": "2024-08-01 17:40:50.045 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "1:06:19.842327", "seconds": 3979.842327}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 17:40:50.045308+05:30", "timestamp": 1722514250.045308}}}
{"text": "2024-08-01 17:46:53.837 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "1:12:23.634888", "seconds": 4343.634888}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 17:46:53.837869+05:30", "timestamp": 1722514613.837869}}}
{"text": "2024-08-01 18:09:21.507 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "1:34:51.304827", "seconds": 5691.304827}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 18:09:21.507808+05:30", "timestamp": 1722515961.507808}}}
{"text": "2024-08-01 18:34:46.225 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "2:00:16.022661", "seconds": 7216.022661}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 12888, "name": "MainProcess"}, "thread": {"id": 20088, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 18:34:46.225642+05:30", "timestamp": 1722517486.225642}}}
{"text": "2024-08-01 19:11:07.059 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:03:13.711208", "seconds": 193.711208}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 24528, "name": "MainProcess"}, "thread": {"id": 5936, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-01 19:11:07.059038+05:30", "timestamp": 1722519667.059038}}}
{"text": "2024-08-02 12:49:23.939 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:06:18.061113", "seconds": 378.061113}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 4460, "name": "MainProcess"}, "thread": {"id": 5100, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-02 12:49:23.939402+05:30", "timestamp": 1722583163.939402}}}
{"text": "2024-08-02 13:19:28.168 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:36:22.289817", "seconds": 2182.289817}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 4460, "name": "MainProcess"}, "thread": {"id": 5100, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-02 13:19:28.168106+05:30", "timestamp": 1722584968.168106}}}
{"text": "2024-08-02 18:02:31.217 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:05:10.456355", "seconds": 310.456355}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 27296, "name": "MainProcess"}, "thread": {"id": 8608, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-02 18:02:31.217338+05:30", "timestamp": 1722601951.217338}}}
{"text": "2024-08-02 18:59:25.324 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "1:02:04.563237", "seconds": 3724.563237}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 27296, "name": "MainProcess"}, "thread": {"id": 8608, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-02 18:59:25.324220+05:30", "timestamp": 1722605365.32422}}}
{"text": "2024-08-02 19:05:24.577 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "1:08:03.816777", "seconds": 4083.816777}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 27296, "name": "MainProcess"}, "thread": {"id": 8608, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-02 19:05:24.577760+05:30", "timestamp": 1722605724.57776}}}
{"text": "2024-08-05 10:53:18.037 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:02:26.444434", "seconds": 146.444434}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 4420, "name": "MainProcess"}, "thread": {"id": 16624, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-05 10:53:18.037414+05:30", "timestamp": 1722835398.037414}}}
{"text": "2024-08-05 11:30:21.960 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:39:30.367292", "seconds": 2370.367292}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 4420, "name": "MainProcess"}, "thread": {"id": 16624, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-05 11:30:21.960272+05:30", "timestamp": 1722837621.960272}}}
{"text": "2024-08-05 16:09:11.175 | ERROR    | __main__:run_subprocess:58 - Subprocess failed with error: 2024-08-05 16:08:44.279 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:123 - Reading file\n2024-08-05 16:08:44.287 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-05 16:08:44.510 | INFO     | app.process:download_files:148 - Dividing into workers :: 5 for total :: 819\n2024-08-05 16:09:11.013 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'harshiya@kgrp.in'\n        |              -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a.csv'\n        -> <function process_upload at 0x0000023E8F922C00>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x0000023E8F922700>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n                  |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_22-04-2024/GST_INVOICE_2199006.z...\n                  |        |   -> <function download_files.<locals>.fetcher at 0x0000023E903B8A40>\n                  |        -> <function Executor.map at 0x0000023EF7E3D580>\n                  -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x0000023E8F980170>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x23e903e0650 state=finished raised OSError>, <Future at 0x23e903e0350 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x0000023EF7E3CA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 456, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 174, in fetcher\n    os.makedirs(target_dir, exist_ok=True)\n    |  |        -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n    |  -> <function makedirs at 0x0000023EF43DD760>\n    -> <module 'os' (frozen)>\n\n  File \"<frozen os>\", line 225, in makedirs\n\nOSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect: './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n\n", "record": {"elapsed": {"repr": "0:00:35.843918", "seconds": 35.843918}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 58, "message": "Subprocess failed with error: 2024-08-05 16:08:44.279 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:123 - Reading file\n2024-08-05 16:08:44.287 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-05 16:08:44.510 | INFO     | app.process:download_files:148 - Dividing into workers :: 5 for total :: 819\n2024-08-05 16:09:11.013 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'harshiya@kgrp.in'\n        |              -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a.csv'\n        -> <function process_upload at 0x0000023E8F922C00>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x0000023E8F922700>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n                  |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_22-04-2024/GST_INVOICE_2199006.z...\n                  |        |   -> <function download_files.<locals>.fetcher at 0x0000023E903B8A40>\n                  |        -> <function Executor.map at 0x0000023EF7E3D580>\n                  -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x0000023E8F980170>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x23e903e0650 state=finished raised OSError>, <Future at 0x23e903e0350 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x0000023EF7E3CA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 456, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 174, in fetcher\n    os.makedirs(target_dir, exist_ok=True)\n    |  |        -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n    |  -> <function makedirs at 0x0000023EF43DD760>\n    -> <module 'os' (frozen)>\n\n  File \"<frozen os>\", line 225, in makedirs\n\nOSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect: './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n", "module": "win", "name": "__main__", "process": {"id": 24192, "name": "MainProcess"}, "thread": {"id": 3568, "name": "MainThread"}, "time": {"repr": "2024-08-05 16:09:11.175725+05:30", "timestamp": 1722854351.175725}}}
{"text": "2024-08-05 16:09:11.179 | ERROR    | __main__:handle_upload:108 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 115, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x0000018F6DEE3B30>\n    │       └ <function run at 0x0000018F6E157880>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x0000018F6E192340>\n    └ <uvicorn.server.Server object at 0x0000018F69E920F0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x0000018F6E1923E0>\n           │       │   └ <uvicorn.server.Server object at 0x0000018F69E920F0>\n           │       └ <function run at 0x0000018F6BC66CA0>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x0000018F6E219D20>\n           │      └ <function Runner.run at 0x0000018F6BC95F80>\n           └ <asyncio.runners.Runner object at 0x0000018F6DEC0230>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000018F6BC8FBA0>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x0000018F6DEC0230>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x0000018F6BD4B6A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x0000018F6BC95940>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x0000018F6B801B20>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finished result=True>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finished result=True>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000018F6E012D50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018F6E...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x0000018F6DEE3B30>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000018F6E012D50>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018F6E...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018F6E...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018F6E1FE8A0>\n          └ <fastapi.applications.FastAPI object at 0x0000018F6DEE3B30>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018F6E2AC860>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018F6E1FCA70>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000018F6E1FE8A0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'localhost:5000', 'connection': 'keep-alive', 'content-length': '156778', 'sec-ch-ua': '\"Not)A;Brand\";v=\"99\"...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000018F6E2AC860>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x0000018F6DF54360>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018F6E1FCA70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000018F6E1FCA70...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018F6E1FD280>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000018F6E1FCA70>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000018F6E1FCA70...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x0000018F6E2B0D40>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x0000018F6E1FD340>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000018F6E1FD280>\n          └ <function wrap_app_handling_exceptions at 0x0000018F6DE72520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2AC9A0>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x0000018F6E1FD340>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2AC9A0>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000018F6E1FD340>>\n          └ <fastapi.routing.APIRouter object at 0x0000018F6E1FD340>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2AC9A0>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x0000018F6DE739C0>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2AC9A0>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x0000018F6E205300>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2AC9A0>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x0000018F6E2B0F50>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000018F6E2ACA40>\n          └ <function wrap_app_handling_exceptions at 0x0000018F6DE72520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000018F6E2ACB80>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000018...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x0000018F6E2ACA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x0000018F6E2B0F50>\n                     └ <function get_request_handler.<locals>.app at 0x0000018F6E205260>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x0000018F6DE71D00>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'harshiya@kgrp.in', 'file': UploadFile(filename='Bulk_invoice_with_Customer_GSTIN (91) (1).csv', size=156351, heade...\n                 │         └ <function handle_upload at 0x0000018F6E1A7920>\n                 └ <fastapi.dependencies.models.Dependant object at 0x0000018F6E1AB9B0>\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 106, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'harshiya@kgrp.in'\n             │              └ './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a.csv'\n             └ <function run_subprocess at 0x0000018F6E1A76A0>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 59, in run_subprocess\n    raise Exception(result.stderr)\n                    │      └ '2024-08-05 16:08:44.279 | INFO     | app.process:process_upload:384 - Processing file\\n2024-08-05 16:08:44.279 | INFO     | ...\n                    └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n\nException: 2024-08-05 16:08:44.279 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:123 - Reading file\n2024-08-05 16:08:44.287 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-05 16:08:44.510 | INFO     | app.process:download_files:148 - Dividing into workers :: 5 for total :: 819\n2024-08-05 16:09:11.013 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'harshiya@kgrp.in'\n        |              -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a.csv'\n        -> <function process_upload at 0x0000023E8F922C00>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x0000023E8F922700>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n                  |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_22-04-2024/GST_INVOICE_2199006.z...\n                  |        |   -> <function download_files.<locals>.fetcher at 0x0000023E903B8A40>\n                  |        -> <function Executor.map at 0x0000023EF7E3D580>\n                  -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x0000023E8F980170>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x23e903e0650 state=finished raised OSError>, <Future at 0x23e903e0350 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x0000023EF7E3CA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 456, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 174, in fetcher\n    os.makedirs(target_dir, exist_ok=True)\n    |  |        -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n    |  -> <function makedirs at 0x0000023EF43DD760>\n    -> <module 'os' (frozen)>\n\n  File \"<frozen os>\", line 225, in makedirs\n\nOSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect: './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n\n", "record": {"elapsed": {"repr": "0:00:35.847922", "seconds": 35.847922}, "exception": {"type": "Exception", "value": "2024-08-05 16:08:44.279 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\n2024-08-05 16:08:44.279 | INFO     | app.process:download_files:123 - Reading file\n2024-08-05 16:08:44.287 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-05 16:08:44.510 | INFO     | app.process:download_files:148 - Dividing into workers :: 5 for total :: 819\n2024-08-05 16:09:11.013 | ERROR    | __main__:<module>:38 - Error during processing\nTraceback (most recent call last):\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        |              |         |      -> 'airline'\n        |              |         -> 'harshiya@kgrp.in'\n        |              -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a.csv'\n        -> <function process_upload at 0x0000023E8F922C00>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 385, in process_upload\n    base, skipped, not_existing, invalid, invalid_s3_url, total, updated_csv_path = download_files(\n                                                                                    -> <function download_files at 0x0000023E8F922700>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 225, in download_files\n    for result in executor.map(fetcher, chunks):\n                  |        |   |        -> [array(['https://airline-engine-scraped.s3.ap-south-1.amazonaws.com/v0/Manual/vistara/output_22-04-2024/GST_INVOICE_2199006.z...\n                  |        |   -> <function download_files.<locals>.fetcher at 0x0000023E903B8A40>\n                  |        -> <function Executor.map at 0x0000023EF7E3D580>\n                  -> <concurrent.futures.thread.ThreadPoolExecutor object at 0x0000023E8F980170>\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 619, in result_iterator\n    yield _result_or_cancel(fs.pop())\n          |                 |  -> <method 'pop' of 'list' objects>\n          |                 -> [<Future at 0x23e903e0650 state=finished raised OSError>, <Future at 0x23e903e0350 state=finished returned tuple>, <Future at...\n          -> <function _result_or_cancel at 0x0000023EF7E3CA40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 317, in _result_or_cancel\n    return fut.result(timeout)\n                      -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 456, in result\n    return self.__get_result()\n           -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\_base.py\", line 401, in __get_result\n    raise self._exception\n          -> None\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\concurrent\\futures\\thread.py\", line 58, in run\n    result = self.fn(*self.args, **self.kwargs)\n             |        |            -> None\n             |        -> None\n             -> None\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 174, in fetcher\n    os.makedirs(target_dir, exist_ok=True)\n    |  |        -> './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n    |  -> <function makedirs at 0x0000023EF43DD760>\n    -> <module 'os' (frozen)>\n\n  File \"<frozen os>\", line 225, in makedirs\n\nOSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect: './data/Bulk_invoice_with_Customer_GSTIN (91) (1)0191221e-b44a-71fd-8338-89a8b611963a\\\\Akasa Air/X5CLYS_Garima.pdf\"'\n", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 108, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 24192, "name": "MainProcess"}, "thread": {"id": 3568, "name": "MainThread"}, "time": {"repr": "2024-08-05 16:09:11.179729+05:30", "timestamp": 1722854351.179729}}}
{"text": "2024-08-05 16:17:17.055 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:01:49.863294", "seconds": 109.863294}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 20484, "name": "MainProcess"}, "thread": {"id": 10920, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-05 16:17:17.055600+05:30", "timestamp": 1722854837.0556}}}
{"text": "2024-08-05 16:46:21.607 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:09:56.753075", "seconds": 596.753075}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 15448, "name": "MainProcess"}, "thread": {"id": 19840, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-05 16:46:21.607049+05:30", "timestamp": 1722856581.607049}}}
{"text": "2024-08-05 18:44:32.114 | ERROR    | app.process:insert_bulk_download:111 - Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n\n", "record": {"elapsed": {"repr": "0:01:23.470476", "seconds": 83.470476}, "exception": null, "extra": {}, "file": {"name": "process.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py"}, "function": "insert_bulk_download", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 111, "message": "Error inserting data into bulk_download table: connection to server at \"ec2-65-1-12-129.ap-south-1.compute.amazonaws.com\" (65.1.12.129), port 5432 failed: Connection timed out (0x0000274C/10060)\n\tIs the server running on that host and accepting TCP/IP connections?\n", "module": "process", "name": "app.process", "process": {"id": 21320, "name": "MainProcess"}, "thread": {"id": 27460, "name": "AnyIO worker thread"}, "time": {"repr": "2024-08-05 18:44:32.114440+05:30", "timestamp": 1722863672.11444}}}
{"text": "2024-08-06 14:01:52.424 | ERROR    | __main__:run_subprocess:58 - Subprocess failed with error: 2024-08-06 13:50:57.986 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-06 13:50:57.986 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:50:57.988 | INFO     | app.process:download_files:123 - Reading file\n2024-08-06 13:50:58.012 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-06 13:50:58.347 | INFO     | app.process:download_files:148 - Dividing into workers :: 34 for total :: 6761\n2024-08-06 13:53:25.032 | INFO     | app.process:process_upload:388 - Downloaded to ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:53:25.033 | INFO     | app.process:convert_html_to_pdf:327 - Converting html to pdf in folder:: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\nTraceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 389, in process_upload\n    convert_html_to_pdf(base)\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 335, in convert_html_to_pdf\n    page.goto(f\"file:///{iname}\")\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 8686, in goto\n    self._sync(\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 113, in _sync\n    self._dispatcher_fiber.switch()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_context_manager.py\", line 56, in greenlet_main\n    self._loop.run_until_complete(self._connection.run_as_sync())\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1949, in _run_once\n    event_list = self._selector.select(timeout)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 445, in select\n    self._poll(timeout)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 774, in _poll\n    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyboardInterrupt\nFuture exception was never retrieved\nfuture: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n\n", "record": {"elapsed": {"repr": "0:11:08.038146", "seconds": 668.038146}, "exception": null, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py"}, "function": "run_subprocess", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 58, "message": "Subprocess failed with error: 2024-08-06 13:50:57.986 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-06 13:50:57.986 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:50:57.988 | INFO     | app.process:download_files:123 - Reading file\n2024-08-06 13:50:58.012 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-06 13:50:58.347 | INFO     | app.process:download_files:148 - Dividing into workers :: 34 for total :: 6761\n2024-08-06 13:53:25.032 | INFO     | app.process:process_upload:388 - Downloaded to ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:53:25.033 | INFO     | app.process:convert_html_to_pdf:327 - Converting html to pdf in folder:: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\nTraceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 389, in process_upload\n    convert_html_to_pdf(base)\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 335, in convert_html_to_pdf\n    page.goto(f\"file:///{iname}\")\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 8686, in goto\n    self._sync(\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 113, in _sync\n    self._dispatcher_fiber.switch()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_context_manager.py\", line 56, in greenlet_main\n    self._loop.run_until_complete(self._connection.run_as_sync())\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1949, in _run_once\n    event_list = self._selector.select(timeout)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 445, in select\n    self._poll(timeout)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 774, in _poll\n    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyboardInterrupt\nFuture exception was never retrieved\nfuture: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n", "module": "win", "name": "__main__", "process": {"id": 3432, "name": "MainProcess"}, "thread": {"id": 18504, "name": "MainThread"}, "time": {"repr": "2024-08-06 14:01:52.424603+05:30", "timestamp": 1722933112.424603}}}
{"text": "2024-08-06 14:01:52.511 | ERROR    | __main__:handle_upload:108 - Error during subprocess execution\nTraceback (most recent call last):\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 115, in <module>\n    uvicorn.run(app, port=port)\n    │       │   │         └ 5000\n    │       │   └ <fastapi.applications.FastAPI object at 0x0000016111083B30>\n    │       └ <function run at 0x00000161112F7880>\n    └ <module 'uvicorn' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\site-packages\\\\uvicorn\\\\__init__....\n\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\main.py\", line 577, in run\n    server.run()\n    │      └ <function Server.run at 0x0000016111332340>\n    └ <uvicorn.server.Server object at 0x000001610FD50D40>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\server.py\", line 65, in run\n    return asyncio.run(self.serve(sockets=sockets))\n           │       │   │    │             └ None\n           │       │   │    └ <function Server.serve at 0x00000161113323E0>\n           │       │   └ <uvicorn.server.Server object at 0x000001610FD50D40>\n           │       └ <function run at 0x000001610EE06CA0>\n           └ <module 'asyncio' from 'C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\Lib\\\\asyncio\\\\__init__.py'>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 194, in run\n    return runner.run(main)\n           │      │   └ <coroutine object Server.serve at 0x00000161113B9D20>\n           │      └ <function Runner.run at 0x000001610EE35F80>\n           └ <asyncio.runners.Runner object at 0x000001611139DD60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\runners.py\", line 118, in run\n    return self._loop.run_until_complete(task)\n           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-p...\n           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001610EE2FBA0>\n           │    └ <ProactorEventLoop running=True closed=False debug=False>\n           └ <asyncio.runners.Runner object at 0x000001611139DD60>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n    │    └ <function ProactorEventLoop.run_forever at 0x000001610EEEB6A0>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n    │    └ <function BaseEventLoop._run_once at 0x000001610EE35940>\n    └ <ProactorEventLoop running=True closed=False debug=False>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1987, in _run_once\n    handle._run()\n    │      └ <function Handle._run at 0x000001610E9B1B20>\n    └ <Handle Task.task_wakeup(<Future finis...1513R1ZD\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\events.py\", line 88, in _run\n    self._context.run(self._callback, *self._args)\n    │    │            │    │           │    └ <member '_args' of 'Handle' objects>\n    │    │            │    │           └ <Handle Task.task_wakeup(<Future finis...1513R1ZD\\r\\n'>)>\n    │    │            │    └ <member '_callback' of 'Handle' objects>\n    │    │            └ <Handle Task.task_wakeup(<Future finis...1513R1ZD\\r\\n'>)>\n    │    └ <member '_context' of 'Handle' objects>\n    └ <Handle Task.task_wakeup(<Future finis...1513R1ZD\\r\\n'>)>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\protocols\\http\\httptools_impl.py\", line 399, in run_asgi\n    result = await app(  # type: ignore[func-returns-value]\n                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000161113FFC80>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\uvicorn\\middleware\\proxy_headers.py\", line 70, in __call__\n    return await self.app(scope, receive, send)\n                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016111...\n                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n                 │    └ <fastapi.applications.FastAPI object at 0x0000016111083B30>\n                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x00000161113FFC80>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\applications.py\", line 1054, in __call__\n    await super().__call__(scope, receive, send)\n                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016111...\n                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\applications.py\", line 123, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016111...\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000016111302AE0>\n          └ <fastapi.applications.FastAPI object at 0x0000016111083B30>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 164, in __call__\n    await self.app(scope, receive, _send)\n          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001611144C720>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x000001611139DDF0>\n          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000016111302AE0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 93, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n          │    │               │      │        │                     └ Headers({'host': 'ea24-171-76-82-43.ngrok-free.app', 'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537...\n          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x000001611144C720>\n          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function CORSMiddleware.simple_response at 0x00000161110F4360>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001611139DDF0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 148, in simple_response\n    await self.app(scope, receive, send)\n          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001611139DDF0...\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001611139CF20>\n          └ <starlette.middleware.cors.CORSMiddleware object at 0x000001611139DDF0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 65, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x000001611139DDF0...\n          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    │    └ <starlette.requests.Request object at 0x0000016111454BC0>\n          │                            │    └ <fastapi.routing.APIRouter object at 0x000001611139D0D0>\n          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x000001611139CF20>\n          └ <function wrap_app_handling_exceptions at 0x0000016111012520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CA40>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <fastapi.routing.APIRouter object at 0x000001611139D0D0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 756, in __call__\n    await self.middleware_stack(scope, receive, send)\n          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CA40>\n          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x000001611139D0D0>>\n          └ <fastapi.routing.APIRouter object at 0x000001611139D0D0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 776, in app\n    await route.handle(scope, receive, send)\n          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CA40>\n          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │     └ <function Route.handle at 0x00000161110139C0>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 297, in handle\n    await self.app(scope, receive, send)\n          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CA40>\n          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │    └ <function request_response.<locals>.app at 0x00000161113A5300>\n          └ APIRoute(path='/api/v2/upload', name='handle_upload', methods=['POST'])\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 77, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CA40>\n          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          │                            │    └ <starlette.requests.Request object at 0x0000016111454DA0>\n          │                            └ <function request_response.<locals>.app.<locals>.app at 0x000001611144CAE0>\n          └ <function wrap_app_handling_exceptions at 0x0000016111012520>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\_exception_handler.py\", line 53, in wrapped_app\n    await app(scope, receive, sender)\n          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x000001611144CC20>\n          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.httptools_impl.RequestResponseCycle object at 0x0000016...\n          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'server': ('127.0.0.1', 5000), 'cl...\n          └ <function request_response.<locals>.app.<locals>.app at 0x000001611144CAE0>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\starlette\\routing.py\", line 72, in app\n    response = await func(request)\n                     │    └ <starlette.requests.Request object at 0x0000016111454DA0>\n                     └ <function get_request_handler.<locals>.app at 0x00000161113A5260>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 278, in app\n    raw_response = await run_endpoint_function(\n                         └ <function run_endpoint_function at 0x0000016111011D00>\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n                 │         │      └ {'email': 'annavarisudhakar@gmail.com', 'file': UploadFile(filename='Bulk_invoice_with_Customer_GSTIN (1).csv', size=1215657,...\n                 │         └ <function handle_upload at 0x0000016111347920>\n                 └ <fastapi.dependencies.models.Dependant object at 0x000001611118D880>\n\n> File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 106, in handle_upload\n    result = run_subprocess(base_filename, email, group_by)\n             │              │              │      └ 'airline'\n             │              │              └ 'annavarisudhakar@gmail.com'\n             │              └ './data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8.csv'\n             └ <function run_subprocess at 0x00000161113476A0>\n\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py\", line 59, in run_subprocess\n    raise Exception(result.stderr)\n                    │      └ '2024-08-06 13:50:57.986 | INFO     | app.process:process_upload:384 - Processing file\\n2024-08-06 13:50:57.986 | INFO     | ...\n                    └ CompletedProcess(args=['C:\\\\Users\\\\annav\\\\AppData\\\\Local\\\\Programs\\\\Python\\\\Python312\\\\python.exe', 'C:\\\\Users\\\\annav\\\\Deskto...\n\nException: 2024-08-06 13:50:57.986 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-06 13:50:57.986 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:50:57.988 | INFO     | app.process:download_files:123 - Reading file\n2024-08-06 13:50:58.012 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-06 13:50:58.347 | INFO     | app.process:download_files:148 - Dividing into workers :: 34 for total :: 6761\n2024-08-06 13:53:25.032 | INFO     | app.process:process_upload:388 - Downloaded to ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:53:25.033 | INFO     | app.process:convert_html_to_pdf:327 - Converting html to pdf in folder:: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\nTraceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 389, in process_upload\n    convert_html_to_pdf(base)\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 335, in convert_html_to_pdf\n    page.goto(f\"file:///{iname}\")\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 8686, in goto\n    self._sync(\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 113, in _sync\n    self._dispatcher_fiber.switch()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_context_manager.py\", line 56, in greenlet_main\n    self._loop.run_until_complete(self._connection.run_as_sync())\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1949, in _run_once\n    event_list = self._selector.select(timeout)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 445, in select\n    self._poll(timeout)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 774, in _poll\n    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyboardInterrupt\nFuture exception was never retrieved\nfuture: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n\n", "record": {"elapsed": {"repr": "0:11:08.125128", "seconds": 668.125128}, "exception": {"type": "Exception", "value": "2024-08-06 13:50:57.986 | INFO     | app.process:process_upload:384 - Processing file\n2024-08-06 13:50:57.986 | INFO     | app.process:download_files:119 - Creating base folder as :: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:50:57.988 | INFO     | app.process:download_files:123 - Reading file\n2024-08-06 13:50:58.012 | INFO     | app.process:download_files:138 - Downloading S3 links\n2024-08-06 13:50:58.347 | INFO     | app.process:download_files:148 - Dividing into workers :: 34 for total :: 6761\n2024-08-06 13:53:25.032 | INFO     | app.process:process_upload:388 - Downloaded to ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\n2024-08-06 13:53:25.033 | INFO     | app.process:convert_html_to_pdf:327 - Converting html to pdf in folder:: ./data/Bulk_invoice_with_Customer_GSTIN (1)019126c6-eb9e-7a77-8e3a-f73d528066b8\nTraceback (most recent call last):\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\processcall.py\", line 21, in <module>\n    ) = process_upload(filename, email, group_by)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 389, in process_upload\n    convert_html_to_pdf(base)\n  File \"C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\app\\process.py\", line 335, in convert_html_to_pdf\n    page.goto(f\"file:///{iname}\")\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 8686, in goto\n    self._sync(\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 113, in _sync\n    self._dispatcher_fiber.switch()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\site-packages\\playwright\\sync_api\\_context_manager.py\", line 56, in greenlet_main\n    self._loop.run_until_complete(self._connection.run_as_sync())\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 674, in run_until_complete\n    self.run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 322, in run_forever\n    super().run_forever()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 641, in run_forever\n    self._run_once()\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\base_events.py\", line 1949, in _run_once\n    event_list = self._selector.select(timeout)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 445, in select\n    self._poll(timeout)\n  File \"C:\\Users\\annav\\AppData\\Local\\Programs\\Python\\Python312\\Lib\\asyncio\\windows_events.py\", line 774, in _poll\n    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nKeyboardInterrupt\nFuture exception was never retrieved\nfuture: <Future finished exception=TargetClosedError('Target page, context or browser has been closed')>\nplaywright._impl._errors.TargetClosedError: Target page, context or browser has been closed\n", "traceback": true}, "extra": {}, "file": {"name": "win.py", "path": "C:\\Users\\annav\\Desktop\\MyProjectFiles\\BulkDownload\\Bulk_download\\win.py"}, "function": "handle_upload", "level": {"icon": "❌", "name": "ERROR", "no": 40}, "line": 108, "message": "Error during subprocess execution", "module": "win", "name": "__main__", "process": {"id": 3432, "name": "MainProcess"}, "thread": {"id": 18504, "name": "MainThread"}, "time": {"repr": "2024-08-06 14:01:52.511585+05:30", "timestamp": 1722933112.511585}}}
